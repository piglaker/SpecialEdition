Wed Dec 29 17:07:27 UTC 2021
Wed Dec 29 17:07:35 UTC 2021
Some weights of the model checkpoint at hfl/chinese-roberta-wwm-ext were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Using amp fp16 backend
***** Running training *****
  Num examples = 284201
  Num Epochs = 10
  Instantaneous batch size per device = 128
  Total train batch size (w. parallel, distributed & accumulation) = 128
  Gradient Accumulation steps = 1
  Total optimization steps = 22210
Loading Dataset !
Hint: The Data You loading now is the preprocessed sighan from ReaLise, 
Hint: Using **SIGHAN15** for eval & test !
Loading Succeed !
Hint: Loading Model *****MaskedLM*****
Hint: MaskedLM, so we load default BertMaskedLM model
  0%|          | 0/22210 [00:00<?, ?it/s]  0%|          | 1/22210 [00:01<7:56:49,  1.29s/it]  0%|          | 2/22210 [00:01<4:31:55,  1.36it/s]  0%|          | 3/22210 [00:01<3:25:33,  1.80it/s]  0%|          | 4/22210 [00:02<2:47:01,  2.22it/s]  0%|          | 5/22210 [00:02<2:26:37,  2.52it/s]  0%|          | 6/22210 [00:02<2:12:37,  2.79it/s]  0%|          | 7/22210 [00:03<2:09:29,  2.86it/s]  0%|          | 8/22210 [00:03<2:15:15,  2.74it/s]  0%|          | 9/22210 [00:03<2:15:13,  2.74it/s]  0%|          | 10/22210 [00:04<2:12:40,  2.79it/s]  0%|          | 11/22210 [00:04<2:17:11,  2.70it/s]  0%|          | 12/22210 [00:05<2:20:16,  2.64it/s]  0%|          | 13/22210 [00:05<2:13:14,  2.78it/s]  0%|          | 14/22210 [00:05<2:10:35,  2.83it/s]  0%|          | 15/22210 [00:06<2:09:52,  2.85it/s]  0%|          | 16/22210 [00:06<2:13:22,  2.77it/s]  0%|          | 17/22210 [00:06<2:16:51,  2.70it/s]  0%|          | 18/22210 [00:07<2:10:02,  2.84it/s]  0%|          | 19/22210 [00:07<2:13:26,  2.77it/s]  0%|          | 20/22210 [00:07<2:12:30,  2.79it/s]  0%|          | 21/22210 [00:08<2:12:48,  2.78it/s]  0%|          | 22/22210 [00:08<2:12:09,  2.80it/s]  0%|          | 23/22210 [00:08<2:10:35,  2.83it/s]  0%|          | 24/22210 [00:09<2:10:46,  2.83it/s]  0%|          | 25/22210 [00:09<2:11:35,  2.81it/s]  0%|          | 26/22210 [00:10<2:16:16,  2.71it/s]  0%|          | 27/22210 [00:10<2:07:22,  2.90it/s]  0%|          | 28/22210 [00:10<2:09:35,  2.85it/s]  0%|          | 29/22210 [00:11<2:14:37,  2.75it/s]  0%|          | 30/22210 [00:11<2:18:34,  2.67it/s]  0%|          | 31/22210 [00:11<2:09:37,  2.85it/s]  0%|          | 32/22210 [00:12<2:08:02,  2.89it/s]  0%|          | 33/22210 [00:12<2:08:05,  2.89it/s]  0%|          | 34/22210 [00:12<2:12:03,  2.80it/s]  0%|          | 35/22210 [00:13<2:10:42,  2.83it/s]  0%|          | 36/22210 [00:13<2:15:46,  2.72it/s]  0%|          | 37/22210 [00:13<2:15:33,  2.73it/s]  0%|          | 38/22210 [00:14<2:17:17,  2.69it/s]  0%|          | 39/22210 [00:14<2:14:03,  2.76it/s]  0%|          | 40/22210 [00:15<2:17:58,  2.68it/s]  0%|          | 41/22210 [00:15<2:16:23,  2.71it/s]  0%|          | 42/22210 [00:15<2:13:52,  2.76it/s]  0%|          | 43/22210 [00:16<2:07:06,  2.91it/s]  0%|          | 44/22210 [00:16<2:10:03,  2.84it/s]  0%|          | 45/22210 [00:16<2:14:41,  2.74it/s]  0%|          | 46/22210 [00:17<2:18:21,  2.67it/s]  0%|          | 47/22210 [00:17<2:09:00,  2.86it/s]  0%|          | 48/22210 [00:17<2:10:58,  2.82it/s]  0%|          | 49/22210 [00:18<2:06:59,  2.91it/s]  0%|          | 50/22210 [00:18<2:13:05,  2.77it/s]  0%|          | 51/22210 [00:19<2:14:06,  2.75it/s]  0%|          | 52/22210 [00:19<2:11:41,  2.80it/s]  0%|          | 53/22210 [00:19<2:16:41,  2.70it/s]  0%|          | 54/22210 [00:20<2:14:06,  2.75it/s]  0%|          | 55/22210 [00:20<2:11:30,  2.81it/s]  0%|          | 56/22210 [00:20<2:14:25,  2.75it/s]  0%|          | 57/22210 [00:21<2:11:35,  2.81it/s]  0%|          | 58/22210 [00:21<2:05:39,  2.94it/s]  0%|          | 59/22210 [00:21<1:59:06,  3.10it/s]  0%|          | 60/22210 [00:22<2:06:52,  2.91it/s]  0%|          | 61/22210 [00:22<2:09:53,  2.84it/s]  0%|          | 62/22210 [00:22<2:08:45,  2.87it/s]  0%|          | 63/22210 [00:23<2:14:39,  2.74it/s]  0%|          | 64/22210 [00:23<2:18:30,  2.66it/s]  0%|          | 65/22210 [00:24<2:17:21,  2.69it/s]  0%|          | 66/22210 [00:24<2:12:11,  2.79it/s]  0%|          | 67/22210 [00:24<2:11:14,  2.81it/s]  0%|          | 68/22210 [00:25<2:14:27,  2.74it/s]  0%|          | 69/22210 [00:25<2:16:42,  2.70it/s]  0%|          | 70/22210 [00:25<2:20:04,  2.63it/s]  0%|          | 71/22210 [00:26<2:10:30,  2.83it/s]  0%|          | 72/22210 [00:26<2:07:14,  2.90it/s]  0%|          | 73/22210 [00:26<2:13:25,  2.77it/s]  0%|          | 74/22210 [00:27<2:15:01,  2.73it/s]  0%|          | 75/22210 [00:27<2:15:18,  2.73it/s]  0%|          | 76/22210 [00:28<2:19:21,  2.65it/s]  0%|          | 77/22210 [00:28<2:22:10,  2.59it/s]  0%|          | 78/22210 [00:28<2:16:22,  2.70it/s]  0%|          | 79/22210 [00:29<2:07:08,  2.90it/s]  0%|          | 80/22210 [00:29<2:10:31,  2.83it/s]  0%|          | 81/22210 [00:29<2:07:19,  2.90it/s]  0%|          | 82/22210 [00:30<2:05:12,  2.95it/s]  0%|          | 83/22210 [00:30<2:08:57,  2.86it/s]  0%|          | 84/22210 [00:30<2:08:47,  2.86it/s]  0%|          | 85/22210 [00:31<2:12:11,  2.79it/s]  0%|          | 86/22210 [00:31<2:05:08,  2.95it/s]  0%|          | 87/22210 [00:31<1:59:51,  3.08it/s]  0%|          | 88/22210 [00:32<2:06:22,  2.92it/s]  0%|          | 89/22210 [00:32<2:10:44,  2.82it/s]  0%|          | 90/22210 [00:32<2:15:03,  2.73it/s]  0%|          | 91/22210 [00:33<2:21:20,  2.61it/s]  0%|          | 92/22210 [00:33<2:24:09,  2.56it/s]  0%|          | 93/22210 [00:34<2:17:39,  2.68it/s]  0%|          | 94/22210 [00:34<2:08:13,  2.87it/s]  0%|          | 95/22210 [00:34<2:12:28,  2.78it/s]  0%|          | 96/22210 [00:35<2:13:23,  2.76it/s]  0%|          | 97/22210 [00:35<2:16:06,  2.71it/s]  0%|          | 98/22210 [00:35<2:19:39,  2.64it/s]  0%|          | 99/22210 [00:36<2:12:59,  2.77it/s]  0%|          | 100/22210 [00:36<2:15:28,  2.72it/s]  0%|          | 101/22210 [00:36<2:09:47,  2.84it/s]  0%|          | 102/22210 [00:37<2:11:12,  2.81it/s]  0%|          | 103/22210 [00:37<2:15:03,  2.73it/s]  0%|          | 104/22210 [00:38<2:15:05,  2.73it/s]  0%|          | 105/22210 [00:38<2:10:47,  2.82it/s]  0%|          | 106/22210 [00:38<2:15:49,  2.71it/s]  0%|          | 107/22210 [00:39<2:11:45,  2.80it/s]  0%|          | 108/22210 [00:39<2:16:24,  2.70it/s]  0%|          | 109/22210 [00:39<2:18:15,  2.66it/s]  0%|          | 110/22210 [00:40<2:18:20,  2.66it/s]  0%|          | 111/22210 [00:40<2:17:19,  2.68it/s]  1%|          | 112/22210 [00:41<2:13:10,  2.77it/s]  1%|          | 113/22210 [00:41<2:10:18,  2.83it/s]  1%|          | 114/22210 [00:41<2:08:35,  2.86it/s]  1%|          | 115/22210 [00:42<2:11:57,  2.79it/s]  1%|          | 116/22210 [00:42<2:07:57,  2.88it/s]  1%|          | 117/22210 [00:42<2:11:28,  2.80it/s]/remote-home/xtzhang/anaconda3/envs/117/lib/python3.8/site-packages/transformers/trainer.py:1317: FutureWarning: Non-finite norm encountered in torch.nn.utils.clip_grad_norm_; continuing anyway. Note that the default behavior will change in a future release to error out if a non-finite total norm is encountered. At that point, setting error_if_nonfinite=false will be required to retain the old behavior.
  nn.utils.clip_grad_norm_(
  1%|          | 118/22210 [00:43<2:04:55,  2.95it/s]  1%|          | 119/22210 [00:43<2:11:27,  2.80it/s]  1%|          | 120/22210 [00:43<2:13:20,  2.76it/s]  1%|          | 121/22210 [00:44<2:14:20,  2.74it/s]  1%|          | 122/22210 [00:44<2:11:56,  2.79it/s]  1%|          | 123/22210 [00:44<2:05:14,  2.94it/s]  1%|          | 124/22210 [00:45<2:08:38,  2.86it/s]  1%|          | 125/22210 [00:45<2:11:09,  2.81it/s]  1%|          | 126/22210 [00:45<2:05:48,  2.93it/s]  1%|          | 127/22210 [00:46<2:07:22,  2.89it/s]  1%|          | 128/22210 [00:46<2:07:17,  2.89it/s]  1%|          | 129/22210 [00:47<2:13:14,  2.76it/s]  1%|          | 130/22210 [00:47<2:12:37,  2.77it/s]  1%|          | 131/22210 [00:47<2:12:55,  2.77it/s]  1%|          | 132/22210 [00:48<2:13:32,  2.76it/s]  1%|          | 133/22210 [00:48<2:17:02,  2.69it/s]  1%|          | 134/22210 [00:48<2:16:17,  2.70it/s]  1%|          | 135/22210 [00:49<2:19:06,  2.64it/s]  1%|          | 136/22210 [00:49<2:19:03,  2.65it/s]  1%|          | 137/22210 [00:49<2:09:13,  2.85it/s]  1%|          | 138/22210 [00:50<2:11:05,  2.81it/s]  1%|          | 139/22210 [00:50<2:09:19,  2.84it/s]  1%|          | 140/22210 [00:50<2:11:40,  2.79it/s]  1%|          | 141/22210 [00:51<2:16:11,  2.70it/s]  1%|          | 142/22210 [00:51<2:07:54,  2.88it/s]  1%|          | 143/22210 [00:52<2:07:12,  2.89it/s]  1%|          | 144/22210 [00:52<2:10:49,  2.81it/s]  1%|          | 145/22210 [00:52<2:03:45,  2.97it/s]  1%|          | 146/22210 [00:53<2:08:26,  2.86it/s]  1%|          | 147/22210 [00:53<2:08:20,  2.87it/s]  1%|          | 148/22210 [00:53<2:11:22,  2.80it/s]  1%|          | 149/22210 [00:54<2:05:18,  2.93it/s]  1%|          | 150/22210 [00:54<2:10:56,  2.81it/s]  1%|          | 151/22210 [00:54<2:12:56,  2.77it/s]