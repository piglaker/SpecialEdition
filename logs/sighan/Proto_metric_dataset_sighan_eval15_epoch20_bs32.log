Fri Feb 18 05:01:45 UTC 2022
Fri Feb 18 05:01:53 UTC 2022
Some weights of the model checkpoint at hfl/chinese-roberta-wwm-ext were not used when initializing ProtoBertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing ProtoBertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ProtoBertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ProtoBertForMaskedLM were not initialized from the model checkpoint at hfl/chinese-roberta-wwm-ext and are newly initialized: ['mlp.weight', 'mlp.bias', 'bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Using amp fp16 backend
***** Running training *****
  Num examples = 284201
  Num Epochs = 20
  Instantaneous batch size per device = 32
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 1
  Total optimization steps = 177640
Loading Dataset !
Hint: The Data You loading now is the preprocessed sighan from ReaLise, 
Hint: Using **SIGHAN15** for eval & test !
Loading Succeed !
Hint: Loading Model *****Proto*****
  0%|          | 0/177640 [00:00<?, ?it/s]/remote-home/xtzhang/anaconda3/envs/117/lib/python3.8/site-packages/transformers/trainer.py:1317: FutureWarning: Non-finite norm encountered in torch.nn.utils.clip_grad_norm_; continuing anyway. Note that the default behavior will change in a future release to error out if a non-finite total norm is encountered. At that point, setting error_if_nonfinite=false will be required to retain the old behavior.
  nn.utils.clip_grad_norm_(
  0%|          | 1/177640 [00:04<233:56:00,  4.74s/it]  0%|          | 2/177640 [00:04<102:13:31,  2.07s/it]  0%|          | 3/177640 [00:05<59:04:28,  1.20s/it]   0%|          | 4/177640 [00:05<39:24:33,  1.25it/s]  0%|          | 5/177640 [00:05<28:09:32,  1.75it/s]  0%|          | 6/177640 [00:05<21:15:13,  2.32it/s]  0%|          | 7/177640 [00:05<17:09:36,  2.88it/s]  0%|          | 8/177640 [00:05<14:56:27,  3.30it/s]  0%|          | 9/177640 [00:06<12:59:07,  3.80it/s]  0%|          | 10/177640 [00:06<11:47:38,  4.18it/s]  0%|          | 11/177640 [00:06<11:22:23,  4.34it/s]  0%|          | 12/177640 [00:06<10:44:36,  4.59it/s]  0%|          | 13/177640 [00:06<10:11:10,  4.84it/s]  0%|          | 14/177640 [00:07<9:39:35,  5.11it/s]   0%|          | 15/177640 [00:07<9:21:14,  5.27it/s]  0%|          | 16/177640 [00:07<9:14:29,  5.34it/s]  0%|          | 17/177640 [00:07<9:05:54,  5.42it/s]  0%|          | 18/177640 [00:07<8:53:57,  5.54it/s]  0%|          | 19/177640 [00:08<8:58:37,  5.50it/s]  0%|          | 20/177640 [00:08<8:53:33,  5.55it/s]  0%|          | 21/177640 [00:08<8:45:39,  5.63it/s]  0%|          | 22/177640 [00:08<8:44:32,  5.64it/s]  0%|          | 23/177640 [00:08<8:39:09,  5.70it/s]  0%|          | 24/177640 [00:08<8:38:43,  5.71it/s]  0%|          | 25/177640 [00:09<8:36:54,  5.73it/s]  0%|          | 26/177640 [00:09<8:47:00,  5.62it/s]  0%|          | 27/177640 [00:09<9:14:49,  5.34it/s]  0%|          | 28/177640 [00:09<9:04:29,  5.44it/s]  0%|          | 29/177640 [00:09<9:00:19,  5.48it/s]  0%|          | 30/177640 [00:09<8:56:03,  5.52it/s]  0%|          | 31/177640 [00:10<9:03:28,  5.45it/s]  0%|          | 32/177640 [00:10<9:52:59,  4.99it/s]  0%|          | 33/177640 [00:10<9:34:45,  5.15it/s]  0%|          | 34/177640 [00:10<9:56:49,  4.96it/s]  0%|          | 35/177640 [00:10<9:36:10,  5.14it/s]  0%|          | 36/177640 [00:11<10:02:24,  4.91it/s]  0%|          | 37/177640 [00:11<10:01:17,  4.92it/s]  0%|          | 38/177640 [00:11<9:35:10,  5.15it/s]   0%|          | 39/177640 [00:11<9:50:56,  5.01it/s]  0%|          | 40/177640 [00:11<9:35:29,  5.14it/s]  0%|          | 41/177640 [00:12<9:21:23,  5.27it/s]  0%|          | 42/177640 [00:12<9:11:06,  5.37it/s]  0%|          | 43/177640 [00:12<8:58:45,  5.49it/s]  0%|          | 44/177640 [00:12<9:45:58,  5.05it/s]  0%|          | 45/177640 [00:12<9:28:49,  5.20it/s]  0%|          | 46/177640 [00:13<9:20:37,  5.28it/s]  0%|          | 47/177640 [00:13<10:01:49,  4.92it/s]  0%|          | 48/177640 [00:13<10:03:07,  4.91it/s]  0%|          | 49/177640 [00:13<9:32:10,  5.17it/s]   0%|          | 50/177640 [00:13<9:10:56,  5.37it/s]  0%|          | 51/177640 [00:14<9:02:50,  5.45it/s]  0%|          | 52/177640 [00:14<8:51:53,  5.56it/s]  0%|          | 53/177640 [00:14<8:47:15,  5.61it/s]  0%|          | 54/177640 [00:14<9:09:14,  5.39it/s]  0%|          | 55/177640 [00:14<9:28:05,  5.21it/s]  0%|          | 56/177640 [00:14<9:12:59,  5.35it/s]  0%|          | 57/177640 [00:15<9:34:31,  5.15it/s]  0%|          | 58/177640 [00:15<9:14:27,  5.34it/s]  0%|          | 59/177640 [00:15<9:06:42,  5.41it/s]  0%|          | 60/177640 [00:15<8:57:48,  5.50it/s]  0%|          | 61/177640 [00:15<9:08:16,  5.40it/s]  0%|          | 62/177640 [00:16<9:00:35,  5.47it/s]  0%|          | 63/177640 [00:16<9:00:30,  5.48it/s]  0%|          | 64/177640 [00:16<9:42:00,  5.09it/s]  0%|          | 65/177640 [00:16<9:23:18,  5.25it/s]  0%|          | 66/177640 [00:16<9:58:06,  4.95it/s]  0%|          | 67/177640 [00:17<9:57:08,  4.96it/s]  0%|          | 68/177640 [00:17<9:33:48,  5.16it/s]  0%|          | 69/177640 [00:17<9:27:27,  5.22it/s]  0%|          | 70/177640 [00:17<9:07:00,  5.41it/s]  0%|          | 71/177640 [00:17<8:59:43,  5.48it/s]  0%|          | 72/177640 [00:17<8:54:50,  5.53it/s]  0%|          | 73/177640 [00:18<8:50:24,  5.58it/s]  0%|          | 74/177640 [00:18<9:22:29,  5.26it/s]  0%|          | 75/177640 [00:18<9:04:19,  5.44it/s]  0%|          | 76/177640 [00:18<9:44:16,  5.07it/s]  0%|          | 77/177640 [00:18<10:01:04,  4.92it/s]  0%|          | 78/177640 [00:19<9:37:00,  5.13it/s]   0%|          | 79/177640 [00:19<9:16:48,  5.31it/s]  0%|          | 80/177640 [00:19<9:05:08,  5.43it/s]  0%|          | 81/177640 [00:19<9:17:23,  5.31it/s]  0%|          | 82/177640 [00:19<9:12:41,  5.35it/s]  0%|          | 83/177640 [00:20<9:41:09,  5.09it/s]  0%|          | 84/177640 [00:20<9:25:36,  5.23it/s]  0%|          | 85/177640 [00:20<9:48:04,  5.03it/s]  0%|          | 86/177640 [00:20<10:03:14,  4.91it/s]  0%|          | 87/177640 [00:20<9:39:03,  5.11it/s]   0%|          | 88/177640 [00:21<9:20:25,  5.28it/s]  0%|          | 89/177640 [00:21<9:37:00,  5.13it/s]  0%|          | 90/177640 [00:21<9:22:19,  5.26it/s]  0%|          | 91/177640 [00:21<9:11:29,  5.37it/s]  0%|          | 92/177640 [00:21<9:23:36,  5.25it/s]  0%|          | 93/177640 [00:22<9:45:52,  5.05it/s]  0%|          | 94/177640 [00:22<9:52:14,  5.00it/s]  0%|          | 95/177640 [00:22<9:28:49,  5.20it/s]  0%|          | 96/177640 [00:22<9:06:57,  5.41it/s]  0%|          | 97/177640 [00:22<9:27:33,  5.21it/s]  0%|          | 98/177640 [00:22<9:15:12,  5.33it/s]  0%|          | 99/177640 [00:23<9:14:52,  5.33it/s]  0%|          | 100/177640 [00:23<9:43:27,  5.07it/s]  0%|          | 101/177640 [00:23<9:15:49,  5.32it/s]  0%|          | 102/177640 [00:23<9:25:17,  5.23it/s]  0%|          | 103/177640 [00:23<9:49:25,  5.02it/s]  0%|          | 104/177640 [00:24<10:20:29,  4.77it/s]  0%|          | 105/177640 [00:24<9:51:51,  5.00it/s]   0%|          | 106/177640 [00:24<9:29:58,  5.19it/s]  0%|          | 107/177640 [00:24<9:09:59,  5.38it/s]  0%|          | 108/177640 [00:24<8:53:30,  5.55it/s]  0%|          | 109/177640 [00:25<8:46:36,  5.62it/s]  0%|          | 110/177640 [00:25<9:24:47,  5.24it/s]  0%|          | 111/177640 [00:25<9:15:59,  5.32it/s]  0%|          | 112/177640 [00:25<9:05:02,  5.43it/s]  0%|          | 113/177640 [00:25<8:55:07,  5.53it/s]  0%|          | 114/177640 [00:26<8:49:40,  5.59it/s]  0%|          | 115/177640 [00:26<9:37:40,  5.12it/s]  0%|          | 116/177640 [00:26<9:50:32,  5.01it/s]  0%|          | 117/177640 [00:26<9:18:26,  5.30it/s]  0%|          | 118/177640 [00:26<9:58:17,  4.95it/s]  0%|          | 119/177640 [00:27<9:42:00,  5.08it/s]  0%|          | 120/177640 [00:27<9:17:31,  5.31it/s]  0%|          | 121/177640 [00:27<9:08:15,  5.40it/s]  0%|          | 122/177640 [00:27<9:00:42,  5.47it/s]  0%|          | 123/177640 [00:27<8:45:02,  5.63it/s]  0%|          | 124/177640 [00:27<8:37:30,  5.72it/s]  0%|          | 125/177640 [00:28<8:38:29,  5.71it/s]  0%|          | 126/177640 [00:28<8:40:04,  5.69it/s]  0%|          | 127/177640 [00:28<8:36:44,  5.73it/s]  0%|          | 128/177640 [00:28<9:04:26,  5.43it/s]  0%|          | 129/177640 [00:28<8:54:14,  5.54it/s]  0%|          | 130/177640 [00:29<9:26:36,  5.22it/s]  0%|          | 131/177640 [00:29<9:12:49,  5.35it/s]  0%|          | 132/177640 [00:29<9:02:30,  5.45it/s]  0%|          | 133/177640 [00:29<8:51:26,  5.57it/s]  0%|          | 134/177640 [00:29<8:34:30,  5.75it/s]  0%|          | 135/177640 [00:29<8:38:44,  5.70it/s]  0%|          | 136/177640 [00:30<9:25:06,  5.24it/s]  0%|          | 137/177640 [00:30<9:40:09,  5.10it/s]  0%|          | 138/177640 [00:30<9:11:08,  5.37it/s]  0%|          | 139/177640 [00:30<8:54:30,  5.53it/s]  0%|          | 140/177640 [00:30<8:47:54,  5.60it/s]  0%|          | 141/177640 [00:31<9:13:06,  5.35it/s]  0%|          | 142/177640 [00:31<8:56:00,  5.52it/s]  0%|          | 143/177640 [00:31<8:46:18,  5.62it/s]  0%|          | 144/177640 [00:31<9:36:22,  5.13it/s]  0%|          | 145/177640 [00:31<9:18:24,  5.30it/s]  0%|          | 146/177640 [00:31<9:47:14,  5.04it/s]  0%|          | 147/177640 [00:32<9:35:26,  5.14it/s]  0%|          | 148/177640 [00:32<9:44:22,  5.06it/s]  0%|          | 149/177640 [00:32<9:19:55,  5.28it/s]  0%|          | 150/177640 [00:32<9:03:34,  5.44it/s]  0%|          | 151/177640 [00:32<9:43:35,  5.07it/s]  0%|          | 152/177640 [00:33<9:28:36,  5.20it/s]  0%|          | 153/177640 [00:33<9:13:18,  5.35it/s]  0%|          | 154/177640 [00:33<9:32:05,  5.17it/s]  0%|          | 155/177640 [00:33<9:41:13,  5.09it/s]  0%|          | 156/177640 [00:33<9:27:30,  5.21it/s]  0%|          | 157/177640 [00:34<9:08:47,  5.39it/s]  0%|          | 158/177640 [00:34<8:52:16,  5.56it/s]  0%|          | 159/177640 [00:34<9:40:28,  5.10it/s]  0%|          | 160/177640 [00:34<9:30:25,  5.19it/s]  0%|          | 161/177640 [00:34<9:09:18,  5.38it/s]  0%|          | 162/177640 [00:35<9:26:10,  5.22it/s]  0%|          | 163/177640 [00:35<9:00:58,  5.47it/s]  0%|          | 164/177640 [00:35<9:32:56,  5.16it/s]  0%|          | 165/177640 [00:35<9:22:32,  5.26it/s]  0%|          | 166/177640 [00:35<9:38:38,  5.11it/s]  0%|          | 167/177640 [00:35<9:09:13,  5.39it/s]  0%|          | 168/177640 [00:36<8:56:05,  5.52it/s]  0%|          | 169/177640 [00:36<8:53:20,  5.55it/s]  0%|          | 170/177640 [00:36<8:51:16,  5.57it/s]  0%|          | 171/177640 [00:36<8:52:23,  5.56it/s]  0%|          | 172/177640 [00:36<8:42:45,  5.66it/s]  0%|          | 173/177640 [00:37<9:02:16,  5.45it/s]  0%|          | 174/177640 [00:37<8:57:55,  5.50it/s]  0%|          | 175/177640 [00:37<8:58:29,  5.49it/s]  0%|          | 176/177640 [00:37<9:34:56,  5.14it/s]  0%|          | 177/177640 [00:37<10:07:52,  4.87it/s]  0%|          | 178/177640 [00:38<9:35:51,  5.14it/s]   0%|          | 179/177640 [00:38<9:10:05,  5.38it/s]  0%|          | 180/177640 [00:38<9:40:09,  5.10it/s]  0%|          | 181/177640 [00:38<9:30:54,  5.18it/s]  0%|          | 182/177640 [00:38<10:08:19,  4.86it/s]  0%|          | 183/177640 [00:39<10:18:58,  4.78it/s]  0%|          | 184/177640 [00:39<10:40:42,  4.62it/s]  0%|          | 185/177640 [00:39<10:06:02,  4.88it/s]  0%|          | 186/177640 [00:39<9:33:08,  5.16it/s]   0%|          | 187/177640 [00:39<9:16:40,  5.31it/s]  0%|          | 188/177640 [00:39<9:05:03,  5.43it/s]  0%|          | 189/177640 [00:40<8:51:44,  5.56it/s]  0%|          | 190/177640 [00:40<8:40:42,  5.68it/s]  0%|          | 191/177640 [00:40<8:34:57,  5.74it/s]  0%|          | 192/177640 [00:40<9:20:54,  5.27it/s]  0%|          | 193/177640 [00:40<9:17:17,  5.31it/s]  0%|          | 194/177640 [00:41<9:07:33,  5.40it/s]  0%|          | 195/177640 [00:41<9:20:11,  5.28it/s]  0%|          | 196/177640 [00:41<9:00:56,  5.47it/s]  0%|          | 197/177640 [00:41<9:23:57,  5.24it/s]